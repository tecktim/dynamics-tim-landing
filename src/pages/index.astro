---
import BaseLayout from '../layouts/BaseLayout.astro';
import Hero from '../components/Hero.astro';
import ServicesGrid from '../components/ServicesGrid.astro';
import ProjectCards from '../components/ProjectCards.astro';
import { getCollection } from 'astro:content';

const base = import.meta.env.BASE_URL ?? '/';
const to = (path: string) => `${base}${path.replace(/^\//, '')}`;

const projects = (await getCollection('projects')).sort((a, b) => (a.data.featured === b.data.featured ? 0 : a.data.featured ? -1 : 1));
const heroServices = [
  {
    title: 'Solution Architektur',
    description: 'Zielbild, Governance & Best Practices für modulare Dynamics 365 Landschaften.'
  },
  {
    title: 'Integrationen & Automatisierung',
    description: 'Azure Functions, Service Bus, Power Automate & Plugins – orchestriert mit DevOps-Pipelines.'
  },
  {
    title: 'Delivery & Enablement',
    description: 'Team-Coaching, Pairing, Quality Gates und produktionsreife Übergabe.'
  },
  {
    title: 'Modernisierung & Performance',
    description: 'Refactoring von Plugins, Telemetrie, Monitoring und messbare Optimierungen.'
  }
];

const valueBullets = [
  {
    title: 'Schnelle Impact-Analyse',
    description: 'Innerhalb von Tagen statt Wochen Klarheit über Risiken, Scope und nächsten Schritte.'
  },
  {
    title: 'Enterprise-ready Delivery',
    description: 'CI/CD, Source Control und Observability als Standard – unabhängig von Teamgröße.'
  },
  {
    title: 'Hands-on Umsetzung',
    description: 'Keine PowerPoint-Schlachten. Ich liefere produktionsreife Ergebnisse mit Code & Tests.'
  }
];
---

<BaseLayout title="Startseite" description="Dynamics 365 (Sales/Service) Entwicklung & Beratung: saubere Architekturen, performante Integrationen, Power Platform, Azure & DevOps.">
  <Hero />

  <section class="bg-surface-100 py-20">
    <div class="mx-auto max-w-6xl px-6">
      <h2 class="section-title" data-reveal data-reveal-delay="0">Warum Tim?</h2>
      <div class="mt-10 grid gap-6 md:grid-cols-3" data-reveal data-reveal-delay="80">
        {valueBullets.map((bullet, index) => (
          <div class="card" data-reveal data-reveal-delay={`${index * 80 + 160}`} key={bullet.title}>
            <h3 class="text-xl font-semibold text-slate-900">{bullet.title}</h3>
            <p class="mt-3 text-base text-slate-600">{bullet.description}</p>
          </div>
        ))}
      </div>
    </div>
  </section>

  <ServicesGrid
    heading="Leistungen"
    subheading="Ob Greenfield oder Sanierung – ich begleite Dynamics 365 Projekte von der Idee bis zum stabilen Betrieb."
    items={heroServices}
  />

  <ProjectCards items={projects.slice(0, 2)} />

  <section class="bg-gradient-to-br from-brand-900 via-brand-800 to-accent-600 py-24 text-white" data-reveal data-reveal-delay="0">
    <div class="mx-auto max-w-5xl px-6 text-center">
      <h2 class="text-3xl font-bold sm:text-4xl" data-reveal data-reveal-delay="0">Bereit für skalierbare Dynamics 365 Lösungen?</h2>
      <p class="mt-4 text-lg text-slate-200" data-reveal data-reveal-delay="80">
        Lass uns im kostenlosen Erstgespräch klären, wie wir Architektur, Delivery und Integrationen gemeinsam beschleunigen.
      </p>
      <div class="mt-8 flex flex-wrap justify-center gap-4" data-reveal data-reveal-delay="160">
        <a href="mailto:hello@dynamics-tim.dev" class="cta-glow rounded-2xl bg-white px-6 py-3 text-base font-semibold text-brand-700 shadow-soft transition hover:bg-surface-200">
          Kostenloses Erstgespräch
        </a>
        <a href={to('services')} class="cta-outline rounded-2xl border border-white/60 px-6 py-3 text-base font-semibold text-white transition hover:bg-white/15">
          Leistungen ansehen
        </a>
      </div>
    </div>
  </section>
</BaseLayout>

